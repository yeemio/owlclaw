# 持续闭环架构待决策清单（OwlClaw × Mionyee）

> 更新时间：2026-02-26  
> 目的：沉淀当前已验证问题，形成可拍板的架构决策项，而非继续“局部补代码”。

---

## 1. 已验证事实（当前共识基线）

1. 我们已具备多条触发能力（cron/webhook/queue/db-change/signal/api）与记忆/治理机制，但尚未形成“单一主驱动闭环”。
2. `heartbeat` 在代码中存在主循环和跳过机制，但事件源检查仍是占位实现（默认返回 `False`），无法独立承担生产持续驱动。
3. 当前可稳定跑通的是“业务调度驱动链路”（例如 Mionyee 的定时任务触发）。
4. `scan -> migrate -> SKILL.md -> mount` 工具链可跑通，但“0代码接入”到“生产持续收益”之间仍缺发布门禁与运营闭环。
5. 若接入后主要依赖聊天触发，定位会退化为助手型产品，不符合“业务系统 Agent 化”定位。

---

## 2. 核心架构决策项（待拍板）

## D1. 主驱动模型

**问题**：OwlClaw 生产主驱动到底是什么？

- 选项 A：聊天/人工触发为主，事件为辅  
- 选项 B：业务事件 + 业务时钟为主，聊天为旁路  
- 选项 C：完全 heartbeat 驱动，其它触发仅喂事件

**建议**：选 B  
**原因**：最符合“传统业务 0 代码接入 Agent 能力”的定位，且与 Mionyee 现状最匹配。

---

## D2. 持续运行拓扑

**问题**：OwlClaw 作为什么形态常驻？

- 选项 A：嵌入业务进程（每个业务系统各跑一份）  
- 选项 B：独立 Gateway/Worker 服务（业务系统仅投递事件）  
- 选项 C：混合（核心独立服务 + 边缘嵌入）

**建议**：选 C（短期 A/B 兼容，长期收敛 B）  
**原因**：先降低迁移成本，再收敛运维与治理一致性。

---

## D3. Heartbeat 角色定位

**问题**：Heartbeat 是主引擎还是节流器？

- 选项 A：主引擎（主动扫描事件源并驱动运行）  
- 选项 B：节流器（仅对“已入队事件”做低成本轮询与触发）  
- 选项 C：仅保留为保底机制

**建议**：选 B  
**原因**：当前实现和风险控制更适配“先事件入队，再 heartbeat 判定”。

---

## D4. Skill 接入标准路径

**问题**：以哪条链路作为官方主路径？

- 选项 A：`migrate --output-mode handler`（代码包装主导）  
- 选项 B：`migrate --output-mode binding`（声明式主导）  
- 选项 C：双轨并行（binding 默认，handler 兜底）

**建议**：选 C（战略 B，战术 C）  
**原因**：短期兼容存量系统差异，长期收敛到 binding + 协议治理。

---

## D5. “自进化”发布门禁

**问题**：学习结果如何进入生产？

- 选项 A：学到即用  
- 选项 B：回放/契约测试通过后灰度  
- 选项 C：仅人工审批发布

**建议**：选 B（高风险动作叠加 C）  
**原因**：兼顾速度与资金风险，适用于股票场景。

---

## D6. “0代码接入”口径定义

**问题**：“0代码”具体指什么？

- 选项 A：业务方完全不写代码（仅配置）  
- 选项 B：业务方不改原系统代码，但需维护 binding/环境变量  
- 选项 C：允许少量 glue code

**建议**：选 B（对外口径需明确）  
**原因**：真实可落地且可规模化，不会过度承诺。

---

## D7. 业务闭环验收口径

**问题**：什么叫“达到目标”？

- 选项 A：链路跑通即可  
- 选项 B：链路跑通 + 指标改善  
- 选项 C：指标改善 + 风险约束稳定

**建议**：选 C  
**股票场景最低验收**：收益、回撤、命中率、误触发率、人工干预率。

---

## 3. 当前主要风险（红军视角）

1. 触发机制多但主路径不清，容易形成“看起来都能用，实际都不闭环”的假繁荣。
2. 若先强调“聊天体验”，产品定位会被市场自动归类为助手，战略失焦。
3. 若自进化无门禁，股票场景会出现“错误进化加速”，直接转化为资金回撤与信任损失。
4. “0代码”口径若不收敛，后续销售承诺与交付现实会发生系统性冲突。

---

## 4. 拍板顺序（建议）

1. 先拍 D1（主驱动）与 D6（0代码口径）  
2. 再拍 D2/D3（运行拓扑与 heartbeat 角色）  
3. 最后拍 D4/D5/D7（接入标准、进化门禁、验收指标）

> 未完成上述拍板前，不建议继续扩写功能点；否则会持续“实现很多机制，但闭环效果不确定”。

