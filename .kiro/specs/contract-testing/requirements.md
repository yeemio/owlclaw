# Requirements: Contract Testing

> **目标**：建立 API + MCP 契约测试体系，确保协议变更可验证、可阻断。  
> **优先级**：P0  
> **预估工作量**：3-5 天

---

## 1. 功能需求

### FR-1 API 契约回归
- [ ] OpenAPI 差异检测纳入 CI
- [ ] breaking 变更默认阻断

### FR-2 MCP 协议回归
- [ ] initialize/tools/resources 核心路径回归
- [ ] 错误语义回归

### FR-3 对齐矩阵
- [ ] 建立 API/MCP 能力与错误域对齐矩阵
- [ ] 对齐矩阵变更受评审门禁

---

## 2. 非功能需求

- **NFR-1**：测试运行可复现（本地与 CI 一致）
- **NFR-2**：回归报告可追溯

---

## 3. DoD

- [ ] API/MCP 契约测试都在 CI 必跑
- [ ] 差异报告自动生成
- [ ] 至少一次 breaking 变更阻断演练

---

**维护者**：测试架构组  
**最后更新**：2026-02-26

